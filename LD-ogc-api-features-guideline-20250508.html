<!DOCTYPE html><html lang="en"><head>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 35.3.0">
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
  
  
  
  
  
<script>document.title = respecConfig.title</script>
<title>OGC API Features Guideline</title>
  
  
  
<link rel="shortcut icon" type="image/x-icon" href="https://tools.geostandaarden.nl/respec/style/logos/Geonovum.ico">
  

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:italic}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline;position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-.7em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style id="respec-nlgov">
img.license{float:left;padding-right:5px;background:0 0}
</style>
<meta name="color-scheme" content="light">
<meta name="description" content="This document is a guideline for Dutch data providers who want to use OGC-API-Features for download services in a way that they comply with relevant standards.
The guideline has been written on the basis of the experiences gained from implementations of OGC-API-Features of INSPIRE datasets on test beds.
A second important basis is formed by the results of an open tender, held in the beginning of 2023. 
This tender aimed at adjusting tools for serving OGC-API-feature services to 4 standards: OAS, OGC, Dutch Application Design Rules and INSPIRE. Until this tender, no tools were known that comply with all these standards.
The aim of setting up these test beds and this guideline, has been to stimulate the Dutch data providers and hosting organizations to start publishing data as OGC API Features.
By doing this, a greater goal is reached: A better use of geospatial data.
This guideline describes the requirements, as set out by the standards and shows examples of how one can comply with the standards.">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>

  .sidelabel {
    position: fixed;
    -webkit-transform-origin: top right;
    right: 100%;
    top: 0;
    -webkit-transform: rotate(-90deg);
    padding: 4px 50px 4px 10px;
    color: white;
    white-space: nowrap;
    z-index: 1;
    background-color: #80CC28;
  }
</style>
<script type="text/javascript">
   /* Any custom mermaid.js scripts will go here. */
  </script>
<style>

  /* Any custom mermaid.js scripts will go here. */
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "nl_organisationName": "Geonovum",
  "nl_organisationPublishURL": "https://docs.geostandaarden.nl/",
  "logos": [
    {
      "src": "https://tools.geostandaarden.nl/respec/style/logos/Geonovum.svg",
      "alt": "Geonovum",
      "id": "Geonovum",
      "height": 67,
      "width": 132,
      "url": "https://www.geonovum.nl/geo-standaarden"
    }
  ],
  "postProcess": [
    null
  ],
  "latestVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/"
  ],
  "thisVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "specStatus",
    "-",
    "specType",
    "-",
    "shortName",
    "-",
    "publishDate"
  ],
  "prevVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "previousMaturity",
    "-",
    "specType",
    "-",
    "shortName",
    "-",
    "previousPublishDate"
  ],
  "useLogo": true,
  "useLabel": true,
  "license": "cc-by",
  "addSectionLinks": true,
  "localizationStrings": {
    "en": {
      "wv": "Editor's draft",
      "cv": "Candidate recommendation",
      "vv": "Proposed recommendation",
      "def": "Recommendation",
      "ld": "Living document",
      "basis": "Document",
      "no": "Norm",
      "st": "Standard",
      "im": "Information model",
      "pr": "Practical guideline",
      "hr": "Guide",
      "wa": "Work process agreement",
      "al": "General",
      "bd": "Governance documentation",
      "bp": "Best practice"
    },
    "nl": {
      "wv": "Werkversie",
      "cv": "Consultatieversie",
      "vv": "Versie ter vaststelling",
      "def": "Vastgestelde versie",
      "ld": "Levend document",
      "basis": "Document",
      "no": "Norm",
      "st": "Standaard",
      "im": "Informatiemodel",
      "pr": "Praktijkrichtlijn",
      "hr": "Handreiking",
      "wa": "Werkafspraak",
      "al": "Algemeen",
      "bd": "Beheerdocumentatie",
      "bp": "Best practice"
    }
  },
  "sotdText": {
    "nl": {
      "sotd": "Status van dit document",
      "def": "Dit is de definitieve versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "wv": "Dit is een werkversie die op elk moment kan worden gewijzigd, verwijderd of vervangen door andere documenten. Het is geen stabiel document.",
      "cv": "Dit is een consultatieversie.",
      "vv": "Dit is de definitieve conceptversie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "basis": "Dit is een document zonder officiële status.",
      "ld": "Dit is een levend document dat regelmatig gewijzigd wordt."
    },
    "en": {
      "sotd": "Status of this document",
      "def": "This is the definitive version of this document. Edits resulting from consultations have been applied.",
      "wv": "This is a working draft that can be changed, removed or replaced by other documents at any time. It is not a stable document.",
      "cv": "This is a stable draft, published for public comment.",
      "vv": "This is the final draft of this document. Edits resulting from consultations have been applied.",
      "basis": "This document has no official standing.",
      "ld": "This is a living document, which is updated regularly."
    }
  },
  "labelColor": {
    "def": "#045D9F",
    "wv": "#FF0000",
    "cv": "#045D9F",
    "vv": "#045D9F",
    "basis": "#80CC28",
    "ld": "#80CC28"
  },
  "licenses": {
    "cc0": {
      "name": "Creative Commons 0 Public Domain Dedication",
      "short": "CC0",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/CC-Licentie.svg"
    },
    "cc-by": {
      "name": "Creative Commons Attribution 4.0 International Public License",
      "short": "CC-BY",
      "url": "https://creativecommons.org/licenses/by/4.0/legalcode",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/cc-by.svg"
    },
    "cc-by-nd": {
      "name": "Creative Commons Naamsvermelding-GeenAfgeleideWerken 4.0 Internationaal",
      "short": "CC-BY-ND",
      "url": "https://creativecommons.org/licenses/by-nd/4.0/legalcode.nl",
      "image": "https://tools.geostandaarden.nl/respec/style/logos/cc-by-nd.svg"
    }
  },
  "localBiblio": {
    "PUB-1": {
      "title": "OGC API Features Part1:Core",
      "href": "https://www.opengis.net/doc/IS/ogcapi-features-1/1.0",
      "status": "V1.0.1",
      "publisher": "OGC",
      "company": "OGC",
      "id": "pub-1"
    },
    "PUB-2": {
      "title": "Setting up an INSPIRE Download service based on the OGC API-Features standard",
      "href": "https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md",
      "status": "V1.0",
      "publisher": "INSPIRE-MIF",
      "company": "Companynaam",
      "id": "pub-2"
    },
    "PUB-3": {
      "title": "Dutch API design rules",
      "href": "https://www.geonovum.nl/over-geonovum/actueel/rest-api-design-rules-op-pas-toe-leg-uit-lijst",
      "status": "19 JULI 2020",
      "publisher": "https://www.geonovum.nl",
      "company": "Geonovum",
      "id": "pub-3"
    },
    "PUB-4": {
      "title": "INSPIRE UML-to-GeoJSON encoding rule",
      "href": "https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/geojson-encoding-rule.md#inspire-requirements-for-encoding-rules",
      "status": "V0.1",
      "publisher": "Working group on Inspire Action 2017.2",
      "company": "Companynaam",
      "id": "pub-4"
    },
    "PUB-5": {
      "title": "OGC API - Features - Part 2: Coordinate Reference Systems by Reference",
      "href": "https://www.opengis.net/doc/IS/ogcapi-features-2/1.0",
      "status": "V1.0",
      "publisher": "OGC",
      "company": "OGC",
      "id": "pub-5"
    },
    "PUB-6": {
      "title": "OGC API - Features - Part 3: Filtering and the Common Query Language",
      "href": "https://www.opengis.net/doc/IS/ogcapi-features-3/1.0",
      "status": "V1.0",
      "publisher": "OGC",
      "company": "OGC",
      "id": "pub-6"
    },
    "PUB-7": {
      "title": "OGC API - Common - Part 1: Common standard for all OGC-APIs",
      "href": "https://www.opengis.net/doc/is/ogcapi-common-1/1.0",
      "status": "V1.0",
      "publisher": "OGC",
      "company": "OGC",
      "id": "pub-7"
    }
  },
  "title": "OGC API Features Guideline",
  "specStatus": "ld",
  "specType": "HR",
  "pubDomain": "api",
  "licence": "cc-by",
  "shortName": "ogc-api-features-guideline",
  "previousPublishDate": "2024-05-14",
  "previousMaturity": "LD",
  "editors": [
    {
      "name": "Pieter Bresters",
      "company": "Geonovum",
      "companyURL": "https://www.geonovum.nl"
    }
  ],
  "authors": [
    {
      "name": "Pieter Bresters",
      "company": "Geonovum",
      "companyURL": "https://www.geonovum.nl"
    }
  ],
  "github": "https://github.com/Geonovum/ogc-api-features-guideline"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/base.css"></head>

<body class="h-entry informative"><div class="head">
    <a class="logo" href="https://www.geonovum.nl/geo-standaarden"><img alt="Geonovum" height="67" id="Geonovum" src="https://tools.geostandaarden.nl/respec/style/logos/Geonovum.svg" width="132">
  </a> <h1 id="title" class="title">OGC API Features Guideline</h1>
    
    <h2>
      Geonovum Guide<br>
      Living document
      <time class="dt-published" datetime="2025-05-08">May 08, 2025</time>
    </h2>
    <dl>
      
      
      <dt>Latest editor's draft:</dt><dd><a href="https://geonovum.github.io/ogc-api-features-guideline/">https://geonovum.github.io/ogc-api-features-guideline/</a></dd>
      
      
      
      
      
      <dt>Editor:</dt>
      <dd class="editor p-author h-card vcard">
    <span class="p-name fn">Pieter Bresters</span> (<a class="p-org org h-org" href="https://www.geonovum.nl">Geonovum</a>)
  </dd>
      
      <dt>Author:</dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Pieter Bresters</span> (<a class="p-org org h-org" href="https://www.geonovum.nl">Geonovum</a>)
  </dd>
      <dt>Participate:</dt><dd>
    <a href="https://github.com/Geonovum/ogc-api-features-guideline/">GitHub Geonovum/ogc-api-features-guideline</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/ogc-api-features-guideline/issues/">File an issue</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/ogc-api-features-guideline/commits/">Commit history</a>
  </dd><dd>
    <a href="https://github.com/Geonovum/ogc-api-features-guideline/pulls/">Pull requests</a>
  </dd>
    </dl>
    
    
    
    <p class="copyright">
            This document is licensed under 
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot"><img class="license" src="https://tools.geostandaarden.nl/respec/style/logos/cc-by.svg" alt="Logo Creative Commons Attribution 4.0 International Public License"><br> Creative Commons Attribution 4.0 International Public License</a>
          </p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory"><h2>Abstract</h2>
<p>This document is a guideline for Dutch data providers who want to use OGC-API-Features for download services in a way that they comply with relevant standards.
The guideline has been written on the basis of the experiences gained from implementations of OGC-API-Features of INSPIRE datasets on test beds.
A second important basis is formed by the results of an open tender, held in the beginning of 2023. 
This tender aimed at adjusting tools for serving OGC-API-feature services to 4 standards: OAS, OGC, Dutch Application Design Rules and INSPIRE. Until this tender, no tools were known that comply with all these standards.
The aim of setting up these test beds and this guideline, has been to stimulate the Dutch data providers and hosting organizations to start publishing data as OGC API Features.
By doing this, a greater goal is reached: A better use of geospatial data.
This guideline describes the requirements, as set out by the standards and shows examples of how one can comply with the standards.</p>
<p>A general recommendation to all parties involved, is to adjust as much as possible to the existing requirements as stated in this document.
The most important recommendations for the hosting organizations is to stimulate data providers to start with OGC API features to increase the use of geospatial data according to standards.
Data providers are recommended to first orientate on the possible work of other data providers in this field. A roadmap is described with the steps needed to be taken by data providers in order to serve OGC-API-Features.</p>
</section>
  <section id="sotd" class="introductory"><h2>Status of this document</h2><p>This is a living document, which is updated regularly.</p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of this document</a></li><li class="tocline"><a class="tocxref" href="#H01"><bdi class="secno">1. </bdi>OGC API Features explained</a></li><li class="tocline"><a class="tocxref" href="#H02"><bdi class="secno">2. </bdi>Roadmap for data providers</a></li><li class="tocline"><a class="tocxref" href="#H03"><bdi class="secno">3. </bdi>Requirements</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#oas"><bdi class="secno">3.1 </bdi>OAS</a></li><li class="tocline"><a class="tocxref" href="#ogc"><bdi class="secno">3.2 </bdi>OGC</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ogc-common"><bdi class="secno">3.2.1 </bdi>OGC common</a></li><li class="tocline"><a class="tocxref" href="#ogc-api-features-core"><bdi class="secno">3.2.2 </bdi>OGC API Features Core</a></li><li class="tocline"><a class="tocxref" href="#ogc-crs-requirements"><bdi class="secno">3.2.3 </bdi>OGC CRS requirements</a></li><li class="tocline"><a class="tocxref" href="#ogc-filtering"><bdi class="secno">3.2.4 </bdi>OGC Filtering</a></li></ol></li><li class="tocline"><a class="tocxref" href="#dutch-api-design-rules"><bdi class="secno">3.3 </bdi>Dutch API design rules</a></li><li class="tocline"><a class="tocxref" href="#inspire"><bdi class="secno">3.4 </bdi>INSPIRE</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#inspire-crs"><bdi class="secno">3.4.1 </bdi>INSPIRE CRS</a></li><li class="tocline"><a class="tocxref" href="#inspire-multilinguality"><bdi class="secno">3.4.2 </bdi>INSPIRE Multilinguality</a></li><li class="tocline"><a class="tocxref" href="#inspire-predefined-download"><bdi class="secno">3.4.3 </bdi>INSPIRE Predefined download</a></li><li class="tocline"><a class="tocxref" href="#inspire-bulk-download"><bdi class="secno">3.4.4 </bdi>INSPIRE Bulk download</a></li><li class="tocline"><a class="tocxref" href="#inspire-and-geojson"><bdi class="secno">3.4.5 </bdi>INSPIRE and GeoJSON</a></li><li class="tocline"><a class="tocxref" href="#inspire-and-gml"><bdi class="secno">3.4.6 </bdi>INSPIRE and GML</a></li><li class="tocline"><a class="tocxref" href="#inspire-describing-encoding"><bdi class="secno">3.4.7 </bdi>INSPIRE Describing encoding</a></li></ol></li><li class="tocline"><a class="tocxref" href="#relevant-documentation"><bdi class="secno">3.5 </bdi>Relevant documentation</a></li></ol></li><li class="tocline"><a class="tocxref" href="#H04"><bdi class="secno">4. </bdi>Examples of implementations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#pygeoapi-versus-requirements"><bdi class="secno">4.1 </bdi>Pygeoapi versus requirements</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#oas-0"><bdi class="secno">4.1.1 </bdi>OAS</a></li><li class="tocline"><a class="tocxref" href="#ogc-0"><bdi class="secno">4.1.2 </bdi>OGC</a></li><li class="tocline"><a class="tocxref" href="#dutch-api-design-rules-0"><bdi class="secno">4.1.3 </bdi>Dutch API design rules</a></li><li class="tocline"><a class="tocxref" href="#inspire-0"><bdi class="secno">4.1.4 </bdi>INSPIRE</a></li><li class="tocline"><a class="tocxref" href="#other-findings-on-pygeoapi"><bdi class="secno">4.1.5 </bdi>Other findings on Pygeoapi</a></li></ol></li><li class="tocline"><a class="tocxref" href="#geoserver-versus-requirements"><bdi class="secno">4.2 </bdi>Geoserver versus requirements</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#oas-1"><bdi class="secno">4.2.1 </bdi>OAS</a></li><li class="tocline"><a class="tocxref" href="#ogc-1"><bdi class="secno">4.2.2 </bdi>OGC</a></li><li class="tocline"><a class="tocxref" href="#dutch-api-design-rules-1"><bdi class="secno">4.2.3 </bdi>Dutch API design rules</a></li><li class="tocline"><a class="tocxref" href="#inspire-1"><bdi class="secno">4.2.4 </bdi>INSPIRE</a></li><li class="tocline"><a class="tocxref" href="#other-findings-on-geoserver"><bdi class="secno">4.2.5 </bdi>Other findings on Geoserver</a></li></ol></li><li class="tocline"><a class="tocxref" href="#deegree-versus-requirements"><bdi class="secno">4.3 </bdi>Deegree versus requirements</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#oas-2"><bdi class="secno">4.3.1 </bdi>OAS</a></li><li class="tocline"><a class="tocxref" href="#ogc-2"><bdi class="secno">4.3.2 </bdi>OGC</a></li><li class="tocline"><a class="tocxref" href="#dutch-api-design-rules-2"><bdi class="secno">4.3.3 </bdi>Dutch API design rules</a></li><li class="tocline"><a class="tocxref" href="#inspire-2"><bdi class="secno">4.3.4 </bdi>INSPIRE</a></li><li class="tocline"><a class="tocxref" href="#other-findings-on-deegree"><bdi class="secno">4.3.5 </bdi>Other findings on Deegree</a></li></ol></li><li class="tocline"><a class="tocxref" href="#gokoala-brt-versus-requirements"><bdi class="secno">4.4 </bdi>Gokoala BRT versus requirements</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#oas-3"><bdi class="secno">4.4.1 </bdi>OAS</a></li><li class="tocline"><a class="tocxref" href="#ogc-3"><bdi class="secno">4.4.2 </bdi>OGC</a></li><li class="tocline"><a class="tocxref" href="#dutch-api-design-rules-3"><bdi class="secno">4.4.3 </bdi>Dutch API design rules</a></li><li class="tocline"><a class="tocxref" href="#inspire-3"><bdi class="secno">4.4.4 </bdi>INSPIRE</a></li><li class="tocline"><a class="tocxref" href="#other-findings-on-gokoala-brt-oapif"><bdi class="secno">4.4.5 </bdi>Other findings on Gokoala BRT OAPIF.</a></li></ol></li><li class="tocline"><a class="tocxref" href="#general-findings"><bdi class="secno">4.5 </bdi>General findings</a></li><li class="tocline"><a class="tocxref" href="#documentation"><bdi class="secno">4.6 </bdi>Documentation</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">A.1 </bdi>Informative references</a></li></ol></li></ol></nav>

  
  <section id="H01"><div class="header-wrapper"><h2 id="x1-ogc-api-features-explained"><bdi class="secno">1. </bdi>OGC API Features explained</h2><a class="self-link" href="#H01" aria-label="Permalink for Section 1."></a></div>
<p>OGC API Features (OAPIF) is a multi-part standard for services that offer the capability to create, modify, and query spatial data on the Web. 
It specifies requirements and recommendations for APIs that want to follow a standard way of sharing feature data. 
The specification is a multi-part document. [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-5" title="OGC API - Features - Part 2: Coordinate Reference Systems by Reference">PUB-5</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-6" title="OGC API - Features - Part 3: Filtering and the Common Query Language">PUB-6</a></cite>].
OAPIF is also the term used for a feature download service by means of an API (Application Program Interface) based on OGC standards. </p>
<p>OAPIF is one of the service types in a larger family of <a href="https://www.ogc.org/publications/">OGC APIs</a>. 
Other types are OGC-API Tiles(<a href="https://www.ogc.org/publications/standard/ogcapi-tiles/">https://www.ogc.org/publications/standard/ogcapi-tiles/</a>) or OGC-API Maps(<a href="https://www.ogc.org/publications/standard/ogcapi-maps/">https://www.ogc.org/publications/standard/ogcapi-maps/</a>). 
The OGC-APIs are a new generation of API's based on a REST protocol, where the older generation (WFS en WMS) are based on SOAP.  </p>
<p>&nbsp;
      </p><figure id="fig-a-new-generation-of-geoservices-ogc-apis">
        <img src="media/OGC-APIs.jpg" alt="OGC-APIs">
        <figcaption><a class="self-link" href="#fig-a-new-generation-of-geoservices-ogc-apis">Figure <bdi class="figno">1</bdi></a> <span class="fig-title">A new generation of geoservices: OGC-APIs</span></figcaption>
      </figure>
    .<p></p>
<p>Since October 2024, a change has been made to the Geostandards on the <a href="https://www.geonovum.nl/over-geonovum/actueel/rest-api-design-rules-op-pas-toe-leg-uit-lijst">Dutch "Apply or Explain" list</a> (Pas Toe of Leg Uit (PTLU) lijst in Dutch) of the Dutch Standardization Forum. 
This list now includes the new generation of standards: OGC API Features and OGC API Tiles. The WMS and WFS profiles have been moved to the list of recommended standards.</p>
<p>OAPIF has been considered as the successor of the OGC WFS standard, but that does not mean it will replace it in the near future, although eventually it might.
At this moment, they are complementary to each other. Where WFS is mainly known and used in the GIS community, the OAPIF is aiming broader at both the GIS- and non GIS-community, like web developers. 
OAPIF is easier to use and needs less knowledge in the spatial domain.
Note as well that WFS adopts the Geography Markup Language (GML) as a default data format. In contrast, OAPIF includes recommendations to support HTML and GeoJSON as encodings.
Implementations of OAPIF may also optionally support GML.</p>
<p>The basis of an OAPIF is the landing page. Examples are shown in <a href="https://geonovum.github.io/ogc-api-features-guideline/#H04">chapter 4</a>.
An OAPIF consists of resources that can be retrieved by typing the corresponding path after the landing page of the OAPIF in a web browser or web application.</p>
<table>
<thead>
<tr>
<th>Resource</th>
<th>Path</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td>Landing page</td>
<td>/</td>
<td>This is the top-level resource, which serves as an entry point.</td>
</tr>
<tr>
<td>Conformance declaration</td>
<td>/conformance</td>
<td>This resource presents information about the functionality that is implemented by the server.</td>
</tr>
<tr>
<td>API definition</td>
<td>/openapi or /api</td>
<td>This resource provides metadata about the API itself. Note that the use of /api on the server is optional and the API definition may be hosted on a completely separate server.</td>
</tr>
<tr>
<td>Feature collections</td>
<td>/collections</td>
<td>This resource lists the feature collections that are offered through the API.</td>
</tr>
<tr>
<td>Feature collection</td>
<td>/collections/{collectionId}</td>
<td>This resource describes the feature collection identified in the path.</td>
</tr>
<tr>
<td>Features</td>
<td>/collections/{collectionId}/items</td>
<td>This resource presents the features that are contained in the collection.</td>
</tr>
<tr>
<td>Feature</td>
<td>/collections/{collectionId}/items/{featureId}</td>
<td>This resource presents the feature that is identified in the path.</td>
</tr>
</tbody></table>
<p>In the API definition, one can find all the supported encodings (HTML, JSON) and parameters that can be given along with the URL, such as a bounding box or a limit of the amount of features.
By default, an OAPIF service will provide access to a single dataset.
Rather than sharing the data as a complete dataset, the OGC API Features standards offer direct, fine-grained access to the data at the feature (object) level.</p>
<p>The best way of understanding the concept is looking at the examples that are discussed in the chapter of <a href="#H04">examples</a>.</p>
<p>Since providing a download service is an INSPIRE requirement when responsible for an INSPIRE dataset, the use of OAPIF can be considered for this purpose.
It is even seen as an endorsed <a href="https://inspire.ec.europa.eu/portfolio/good-practice-library/" target="_blank">Good Practice</a> within the INSPIRE community.
In the European Open Data Directive (EU) 2019/1024, the European Commission designates a list of thematic categories of high-value datasets (the ‘High Value Datasets’ (HVD)). This directive also endorses the use of OGC-APIs.
For the Dutch data providers there is a special <a href="https://docs.geostandaarden.nl/eu/handreiking-hvd/#289E9E05">HVD guideline</a> and an <a href="https://docs.geostandaarden.nl/eu/INSPIRE-handreiking/">INSPIRE guideline</a>.</p>
<p>While the OAPIF is aiming at the non GIS-community, it is also easy to use for GIS-specialists within a GIS as is shown in the image below.
It works the same as loading a WFS. Only a service name and landing page is required. 
&nbsp;
      </p><figure id="fig-example-of-using-oapif-in-qgis">
        <img src="media/GIS-example.png" alt="GIS-example">
        <figcaption><a class="self-link" href="#fig-example-of-using-oapif-in-qgis">Figure <bdi class="figno">2</bdi></a> <span class="fig-title">Example of using OAPIF in QGIS</span></figcaption>
      </figure>
    <p></p>
</section>
  <section id="H02"><div class="header-wrapper"><h2 id="x2-roadmap-for-data-providers"><bdi class="secno">2. </bdi>Roadmap for data providers</h2><a class="self-link" href="#H02" aria-label="Permalink for Section 2."></a></div>
<p>The following steps could be considered to follow in order to serve an OGC API Feature service according to the standards:</p>
<table>
<thead>
<tr>
<th>nr</th>
<th>main step</th>
<th>step</th>
<th>general remarks</th>
<th>INSPIRE remarks</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>preparation</td>
<td>reading</td>
<td><a href="#references">Appendix A</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>]</td>
</tr>
<tr>
<td>2</td>
<td>preparation</td>
<td>choose your hosting method</td>
<td>By yourself or an hosting organization.</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>preparation</td>
<td>study <a href="#H04">examples</a></td>
<td></td>
<td>Look what other INSPIRE data providers have done in this field for the concerning INSPIRE themes and have a look at: <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/tree/master/deployments">https://github.com/INSPIRE-MIF/gp-ogc-api-features/tree/master/deployments</a>.</td>
</tr>
<tr>
<td>4</td>
<td>preparation</td>
<td>select the server tool</td>
<td>The <a href="#H04">examples</a> in this guideline might help.</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>preparation</td>
<td>select supported CRS's and timezones</td>
<td>At least <a href="https://epsg.io/4326">WGS84</a> and UTC with an optional timeoffset if datatype <a href="https://tools.ietf.org/html/rfc3339#section-5.6">DateTime</a> is used. Dutch data owners are also advised to provide the <a href="https://www.opengis.net/def/crs/EPSG/0/28992">Dutch RD</a> as CRS and optional the local time zone with timeoffset to UTC (+02:00 in summer en +01:00 in winter).</td>
<td>A projection based on <a href="https://epsg.io/4258">ETRS89</a> is required as one of the CRS's.</td>
</tr>
<tr>
<td>6</td>
<td>preparation</td>
<td>decide on input encoding</td>
<td>depends on previous decisions</td>
<td></td>
</tr>
<tr>
<td>7</td>
<td>preparation</td>
<td>decide on output encoding</td>
<td>depends on previous decisions</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>data preparation</td>
<td>input data transformation</td>
<td>In many cases the original dataset needs to be adjusted or transformed into an encoding that can be used in the OAF-server tool. This can be done with software like <a href="https://wetransform.to/halestudio/">HALE studio</a>, <a href="https://www.safe.com/">FME</a> or <a href="https://gdal.org/index.html">GDAL</a>.</td>
<td>IINSPIRE data models are often complex. Research whether a previously published mapping to an encoding other than complex GML can be found for the concerned INSPIRE-theme. If so, it can be reused. If it cannot be found, research how your harmonized data can be mapped to an encoding that can be used in the tooling. Seek for cooperation with other INSPIRE data providers in Europe and use the principles as stated in [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-4" title="INSPIRE UML-to-GeoJSON encoding rule">PUB-4</a></cite>].</td>
</tr>
<tr>
<td>9</td>
<td>data preparation</td>
<td>publishing the description of the output encoding</td>
<td>This is only required for INSPIRE.</td>
<td>If not published before, describe the mapping from the INSPIRE data model to the output encoding of the OAPIF and publish it, in order to be INSPIRE compliant.</td>
</tr>
<tr>
<td>10</td>
<td>data preparation</td>
<td>publish metadata of the dataset</td>
<td>Adjust your metadata of the dataset with the addition of the OAPIF service as an online resource in a CI_OnlineResource element. The <a href="https://docs.geostandaarden.nl/md/mdprofiel-iso19115/#protocol">ISO19115 metadata standard</a> uses the protocol element to state the type of service. A new protocol "OGC API-Features" was added to the list of <a href="https://inspire.ec.europa.eu/metadata-codelist/ProtocolValue:1">protocol values</a>. But the given <a href="http://www.opengis.net/def/docs/17-069r3">link</a> behind the label does not resolve. The Dutch profile for metadata can also be used with the value: <a href="https://geonovum.github.io/Metadata-ISO19119/#codelist-protocol">"OGC:API features"</a>. The <a href="http://www.opengis.net/def/interface/ogcapi-features">uri</a> provided there, does also not resolve.</td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>service preparation</td>
<td>publish metadata of the service</td>
<td>If you host your OAPIF yourself, you could create metadata for the OAPIF service. It is probably similar to the metadata of a WFS, except for the protocol element.</td>
<td>For Inspire this is not mandatory anymore.</td>
</tr>
<tr>
<td>12</td>
<td>service preparation</td>
<td>add links</td>
<td>Add as many links, i.e. references to other resources, as you can at the response to the endpoints of your service to describe your service.</td>
<td>All the links as mentioned in the chapter on <a href="#H03">requirements</a> are required (metadata of dataset, INSPIRE feature concept dictionary, Licence, mapping description, bulk download).</td>
</tr>
<tr>
<td>13</td>
<td>service preparation</td>
<td>final publishing</td>
<td>The steps for final actual publishing of the OAPIF service depends on the chosen tool, so there the tooling guidelines need to be followed. See list below.</td>
<td></td>
</tr>
<tr>
<td>14</td>
<td>validation</td>
<td>validate the service</td>
<td>Validate the OAPIF service for the OGC requirement with the <a href="https://inspire.ec.europa.eu/validator/home/index.html">INSPIRE validation tool</a> and in case of a Dutch provider: the <a href="https://gitlab.com/commonground/don/adr-validator/-/blob/main/README.md?ref_type=heads">Dutch ADR-validator</a>. Geonovum is developing an other <a href="https://geonovum-labs.github.io/ogc-checker/?#/ogc-api">validator based on Linter</a>. Adjust where possible to be compliant.</td>
<td>It should be noted that the INSPIRE-validator is the same as the <a href="https://cite.opengeospatial.org/teamengine/about/ogcapi-features-1.0/1.0/site/">OGC validator</a> and that it does not test the specific INSPIRE requirements as one would expect.</td>
</tr>
</tbody></table>
<p>Guidelines for different tooling:  </p>
<ul>
<li>Geonovum testbed: <a href="https://github.com/Geonovum/ogc-api-testbed/tree/main/docs/docs/howto">https://github.com/Geonovum/ogc-api-testbed/tree/main/docs/docs/howto</a>  </li>
<li>GoKoala: <a href="https://github.com/PDOK/gokoala">https://github.com/PDOK/gokoala</a>   </li>
<li>Pygeoapi: <a href="https://github.com/Geonovum/ogc-api-testbed/blob/main/docs/docs/howto/howto_pygeoapi.md">https://github.com/Geonovum/ogc-api-testbed/blob/main/docs/docs/howto/howto_pygeoapi.md</a> or <a href="https://docs.pygeoapi.io/en/latest/">https://docs.pygeoapi.io/en/latest/</a>  </li>
<li>Geoserver: <a href="https://github.com/Geonovum/ogc-api-testbed/blob/main/docs/docs/howto/howto_geoserver.md">https://github.com/Geonovum/ogc-api-testbed/blob/main/docs/docs/howto/howto_geoserver.md</a> or <a href="https://docs.geoserver.org/latest/en/user/">https://docs.geoserver.org/latest/en/user/</a>  </li>
<li>Deegree: <a href="https://github.com/deegree/deegree-ogcapi">https://github.com/deegree/deegree-ogcapi</a></li>
</ul>
</section>
  <section id="H03"><div class="header-wrapper"><h2 id="x3-requirements"><bdi class="secno">3. </bdi>Requirements</h2><a class="self-link" href="#H03" aria-label="Permalink for Section 3."></a></div>
<p>Below the most relevant requirements (or requirement classes) for setting up an OAPIF are listed:</p>
<table>
<thead>
<tr>
<th>Source</th>
<th>requirements</th>
<th>reference</th>
</tr>
</thead>
<tbody><tr>
<td>OAS</td>
<td>Open API Specification</td>
<td><a href="https://www.openapis.org/">https://www.openapis.org/</a></td>
</tr>
<tr>
<td>OGC</td>
<td><a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0">OGC API Features-Part1: Core</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>]</td>
</tr>
<tr>
<td>OGC</td>
<td><a href="https://www.opengis.net/doc/IS/ogcapi-features-2/1.0">OGC API Features-Part2: CRS</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-5" title="OGC API - Features - Part 2: Coordinate Reference Systems by Reference">PUB-5</a></cite>]</td>
</tr>
<tr>
<td>OGC</td>
<td><a href="https://www.opengis.net/doc/IS/ogcapi-features-3/1.0">OGC API Features-Part3: filtering</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-6" title="OGC API - Features - Part 3: Filtering and the Common Query Language">PUB-6</a></cite>]</td>
</tr>
<tr>
<td>OGC</td>
<td><a href="https://www.ogc.org/publications/standard/ogcapi-common/">OGC API common</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-7" title="OGC API - Common - Part 1: Common standard for all OGC-APIs">PUB-7</a></cite>]</td>
</tr>
<tr>
<td>Dutch ADR</td>
<td><a href="https://www.geonovum.nl/over-geonovum/actueel/rest-api-design-rules-op-pas-toe-leg-uit-lijst">Dutch API design rules</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-3" title="Dutch API design rules">PUB-3</a></cite>]</td>
</tr>
<tr>
<td>INSPIRE</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md">INPSIRE-MIF document: Setting up an INSPIRE Download service based on the OGC API-Features standard</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>]</td>
</tr>
<tr>
<td>INSPIRE</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-crs">CRS requirements</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] #req-crs</td>
</tr>
<tr>
<td>INSPIRE</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#82-requirements-class-inspire-multilinguality-">multilinguality</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] #82-requirements-class-inspire-multilinguality-</td>
</tr>
<tr>
<td>INSPIRE</td>
<td>[predefined download](<a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-pre-defined">https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-pre-defined</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] #req-pre-defined</td>
</tr>
<tr>
<td>INSPIRE</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-bulk-download">bulk download</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] #req-bulk-download</td>
</tr>
<tr>
<td>INSPIRE</td>
<td><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-oapif-json">GeoJSON</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] #req-oapif-json</td>
</tr>
<tr>
<td>INSPIRE</td>
<td>INSPIRE validated GML as <a href="https://inspire.ec.europa.eu/validator/about/">input</a> and <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_requirements_class_geography_markup_language_gml_simple_features_profile_level_2">output</a></td>
<td><a href="https://inspire.ec.europa.eu/validator/about/">https://inspire.ec.europa.eu/validator/about/</a> and [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>] #_requirements_classes_for_encodings</td>
</tr>
<tr>
<td>INSPIRE</td>
<td><a href="https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/geojson-encoding-rule.md#inspire-requirements-for-encoding-rules">describing encoding</a></td>
<td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-4" title="INSPIRE UML-to-GeoJSON encoding rule">PUB-4</a></cite>]</td>
</tr>
</tbody></table>
<section id="oas"><div class="header-wrapper"><h3 id="x3-1-oas"><bdi class="secno">3.1 </bdi>OAS</h3><a class="self-link" href="#oas" aria-label="Permalink for Section 3.1"></a></div>
<p>The Open API Specification as set up by the <a href="https://openapis.org/">OpenAPI Initiative</a> requires a document that describes an API or elements of an API. 
It can mostly be obtained by typing "openapi" behind the URL of the landing page of the service.
An OpenAPI document uses and conforms to the <a href="https://spec.openapis.org/oas/v3.1.0">OpenAPI Specification</a>.
It describes all the possible fields that can or should be used in the OpenAPI document.
The fields "openapi", "info" are required.
If the servers field is not provided, or contains an empty array, the default value would be a Server Object with a url value of /.
The OpenAPI document <em class="rfc2119">MUST</em> contain at least one paths field, a components field or a webhooks field.</p>
</section><section id="ogc"><div class="header-wrapper"><h3 id="x3-2-ogc"><bdi class="secno">3.2 </bdi>OGC</h3><a class="self-link" href="#ogc" aria-label="Permalink for Section 3.2"></a></div>
<section id="ogc-common"><div class="header-wrapper"><h4 id="x3-2-1-ogc-common"><bdi class="secno">3.2.1 </bdi>OGC common</h4><a class="self-link" href="#ogc-common" aria-label="Permalink for Section 3.2.1"></a></div>
<p><a href="https://www.opengis.net/doc/is/ogcapi-common-1/1.0">The OGC-common standard</a> has been established after the establishment of other OGC-standards like the OGC API Features Core standard.
In the course of developing these Standards, some practices proved to be common across multiple OGC Web API Standards.
The purpose of the OGC API — Common — Part 1: Core Standard (API-Core) is to define those fundamental building blocks and requirements which are applicable to all OGC Web API Standards.
It contains 4 requirement classes:</p>
<ol>
<li>Core Requirements Class. It is about: HTTP protocol, parameters, Support for Cross-Origin Requests, resource encoddings</li>
<li>Landing Page Requirements Class. It is about: conformances and API-definitions</li>
<li>Encoding Requirements Classes: Json and HTML</li>
<li>OpenAPI 3.0 Requirements Class: <a href="https://spec.openapis.org/oas/v3.0">OpenAPI Specification 3.0</a> is required in json and html which is not in accordance with the OGC API Features Core standard.</li>
</ol>
</section><section id="ogc-api-features-core"><div class="header-wrapper"><h4 id="x3-2-2-ogc-api-features-core"><bdi class="secno">3.2.2 </bdi>OGC API Features Core</h4><a class="self-link" href="#ogc-api-features-core" aria-label="Permalink for Section 3.2.2"></a></div>
<p><a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0">OGC API Features Core</a>, [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>] describes the basic requirements (51) and recommendations (22) according to OGC that one needs to follow, independent of INSPIRE. 
It describes which paths can be used and what responses one should receive. 
It does not make the use of the <a href="https://spec.openapis.org/oas/v3.0">OpenAPI Specification 3.0</a> mandatory, but if it is used, it gives an extra <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#rc_oas30">requirement class</a>.
Presumably, this also counts for higher versions of the OpenAPI Specification.</p>
<p>The <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_requirements_class_geojson">GeoJSON requirement class</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>] recommends to support GeoJSON for features with geometry, but as stated in <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_encodings">https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_encodings</a>, no encoding is mandatory. </p>
<p><a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#rec_core_fc-md-descriptions">Metadata links</a> are recommended in [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>] #rec_core_fc-md-descriptions.</p>
<p>There is an <a href="https://inspire.ec.europa.eu/validator/home/index.html">INSPIRE validation</a> on the OGC standards for OAPIF available. It tests on OGC requirements, but it does not test the requirements as stated in [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>].
&nbsp;&nbsp;
      </p><figure id="fig-validation-on-the-ogc-standards-for-oapif">
        <img src="media/INSPIRE_validator_OAPIF.png" alt="INSPIRE Validator">
        <figcaption><a class="self-link" href="#fig-validation-on-the-ogc-standards-for-oapif">Figure <bdi class="figno">3</bdi></a> <span class="fig-title">Validation on the OGC standards for OAPIF</span></figcaption>
      </figure>
    <p></p>
</section><section id="ogc-crs-requirements"><div class="header-wrapper"><h4 id="x3-2-3-ogc-crs-requirements"><bdi class="secno">3.2.3 </bdi>OGC CRS requirements</h4><a class="self-link" href="#ogc-crs-requirements" aria-label="Permalink for Section 3.2.3"></a></div>
<p>Both OGC and INSPIRE have requirements related to the CRS's used in addition to the basic requirement from the OGC API Features Core standard.
The <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_coordinate_reference_systems">CRS requirement</a> in the OGC API Features Core standard [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>], requires <a href="http://www.opengis.net/def/crs/OGC/1.3/CRS84">WGS84</a> for 2D-data and <a href="http://www.opengis.net/def/crs/OGC/0/CRS84h">WGS84h</a> for 3D-data as default.
The <a href="https://www.opengis.net/doc/IS/ogcapi-features-2/1.0">OGC API - Features - Part 2 standard</a>, [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-5" title="OGC API - Features - Part 2: Coordinate Reference Systems by Reference">PUB-5</a></cite>] prescribes how to support different coordinate systems with OAPIF.
Among other requirements, the requirements concern a CRS identifier list, Storage-CRS, a bbox-crs parameter and a content-CRS in the header of the body of the response.</p>
</section><section id="ogc-filtering"><div class="header-wrapper"><h4 id="x3-2-4-ogc-filtering"><bdi class="secno">3.2.4 </bdi>OGC Filtering</h4><a class="self-link" href="#ogc-filtering" aria-label="Permalink for Section 3.2.4"></a></div>
<p>The specification for <a href="https://www.opengis.net/doc/IS/ogcapi-features-3/1.0">filtering</a>, [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-6" title="OGC API - Features - Part 3: Filtering and the Common Query Language">PUB-6</a></cite>] has become an established standard after the publication of the examples. 
This standard has therefore not yet been taken into account in chapter 4.
Some basic filtering requirements are described in <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_items_">OGC API - Features - Part 1: Core</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>].
This only concerns filtering with a bounding box and on properties.
The specification for <a href="https://www.opengis.net/doc/IS/ogcapi-features-3/1.0">filtering</a> gives a full overview of extra requirement regarding filtering.
Some of them are listed below:</p>
<ul>
<li>Queryables: This requirements class defines the Queryables resource for discovering a list of resource properties with their types and constraints that may be used to construct filter expressions on a collection of resources, for example, a set of features.</li>
<li>For every feature collection, the server <em class="rfc2119">SHALL</em> support the Queryables resource at the path /collections/{collectionId}/queryables.</li>
<li>There is a parameter <a href="https://www.opengis.net/doc/IS/ogcapi-features-3/1.0#filter-param">filter</a> to define the filter as a string like <em>filter='property=value'</em></li>
<li>There is a parameter <a href="https://www.opengis.net/doc/IS/ogcapi-features-3/1.0#filter-lang-param">filter-lang</a>  to define the filter language (CQL2-json or CQL2-text)</li>
<li>There is a parameter <a href="https://www.opengis.net/doc/IS/ogcapi-features-3/1.0#filter-crs-param">filter-crs</a> to define the CRS for posted geometries for filtering</li>
<li>If the server supports CQL2 and the requirements class "Functions", then a resource '/functions' is published that allows clients to discover the list of functions that a server offers.</li>
</ul>
</section></section><section id="dutch-api-design-rules"><div class="header-wrapper"><h3 id="x3-3-dutch-api-design-rules"><bdi class="secno">3.3 </bdi>Dutch API design rules</h3><a class="self-link" href="#dutch-api-design-rules" aria-label="Permalink for Section 3.3"></a></div>
<p>Dutch data providers are recommended to follow the <a href="https://www.geonovum.nl/over-geonovum/actueel/rest-api-design-rules-op-pas-toe-leg-uit-lijst">Dutch API design rules</a>, [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-3" title="Dutch API design rules">PUB-3</a></cite>] and the <a href="https://docs.geostandaarden.nl/api/API-Strategie-mod-geo/">Geomodule</a>. </p>
<p>For the Dutch data providers, it is recommended to also support <a href="https://www.opengis.net/def/crs/EPSG/0/28992">RD-coordinatesystem</a> for 2D data or <a href="https://www.opengis.net/def/crs/EPSG/0/7415">RD +NAP</a> for 3D data. See also: <a href="https://docs.geostandaarden.nl/crs/crs">https://docs.geostandaarden.nl/crs/crs</a>. </p>
<p>There has been some confusion about the <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/naming-collections">rule for naming collections</a>. 
One might think that this is about the name of the feature collection or {collectionId}. 
However, this rule is about the higher level "collections" which is plural and standard for the OGC-API-Features structure. There are no rules for being plural or non-plural for the {collectionId}. See also the concerning <a href="https://github.com/Geonovum/KP-APIs/issues/631#issuecomment-2696680537">github-issue</a> the structure below:</p>
<pre><code aria-busy="false" class="hljs">/collections/{collectionId}/items/{featureId}
</code></pre>
<p>The rule <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash">"no-trailing-slash"</a> in the Dutch ADR prescribes that none of the API endpoints should have a trailing slash. However, the OGC specification states that the landing page (i.e. "Home") should have a trailing slash. So the rules contradict.
It is expected that in future, this ADR-rule will make an exception for the landing page. See also <a href="https://github.com/Geonovum/KP-APIs/issues/624">https://github.com/Geonovum/KP-APIs/issues/624</a> </p>
</section><section id="inspire"><div class="header-wrapper"><h3 id="x3-4-inspire"><bdi class="secno">3.4 </bdi>INSPIRE</h3><a class="self-link" href="#inspire" aria-label="Permalink for Section 3.4"></a></div>
<p><a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md">INSPIRE-MIF document: Setting up an INSPIRE Download service based on the OGC API-Features standard</a>, [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] describes the specific INSPIRE requirements.
Most of them are explained in the next chapters.
This document does propose in <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#81-requirements-class-inspire-pre-defined-data-set-download-oapif--">Note 2</a> to make it a mandatory requirement for INSPIRE to comply with <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#rc_oas30">OAPIF requirements class OpenAPI 3.0.</a></p>
<section id="inspire-crs"><div class="header-wrapper"><h4 id="x3-4-1-inspire-crs"><bdi class="secno">3.4.1 </bdi>INSPIRE CRS</h4><a class="self-link" href="#inspire-crs" aria-label="Permalink for Section 3.4.1"></a></div>
<p>The <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-crs">INSPIRE-CRS requirement class</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] requires also one of the INSPIRE CRS's based on ETRS89 to be supported.</p>
</section><section id="inspire-multilinguality"><div class="header-wrapper"><h4 id="x3-4-2-inspire-multilinguality"><bdi class="secno">3.4.2 </bdi>INSPIRE Multilinguality</h4><a class="self-link" href="#inspire-multilinguality" aria-label="Permalink for Section 3.4.2"></a></div>
<p>The <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#82-requirements-class-inspire-multilinguality-">multilinguality requirement class</a>, [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] is mandatory for all data sets that contain information in more than one natural language.
This is mostly not the case in the Netherlands, so it is of less importance.</p>
</section><section id="inspire-predefined-download"><div class="header-wrapper"><h4 id="x3-4-3-inspire-predefined-download"><bdi class="secno">3.4.3 </bdi>INSPIRE Predefined download</h4><a class="self-link" href="#inspire-predefined-download" aria-label="Permalink for Section 3.4.3"></a></div>
<p>The <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-pre-defined">predefined download requirement class</a>,[<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] consists of 3 requirements for each collection to include links to:</p>
<ol>
<li>the <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#metadata-elements-of-the-data-set">metadata of the corresponding dataset</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>]</li>
<li>the corresponding entry in the <a href="https://inspire.ec.europa.eu/featureconcept">INSPIRE feature concept dictionary</a></li>
<li>the <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#terms-of-use">license</a></li>
</ol>
</section><section id="inspire-bulk-download"><div class="header-wrapper"><h4 id="x3-4-4-inspire-bulk-download"><bdi class="secno">3.4.4 </bdi>INSPIRE Bulk download</h4><a class="self-link" href="#inspire-bulk-download" aria-label="Permalink for Section 3.4.4"></a></div>
<p>The <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-bulk-download">bulk download requirement class</a>, [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] requires links for enclosure of the total data set and/or of each separate collection.</p>
</section><section id="inspire-and-geojson"><div class="header-wrapper"><h4 id="x3-4-5-inspire-and-geojson"><bdi class="secno">3.4.5 </bdi>INSPIRE and GeoJSON</h4><a class="self-link" href="#inspire-and-geojson" aria-label="Permalink for Section 3.4.5"></a></div>
<p>The <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#req-oapif-json">GeoJSON requirement class</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-2" title="Setting up an INSPIRE Download service based on the OGC API-Features standard">PUB-2</a></cite>] recommends to document how the GeoJSON encoding is retrieved from the INSPIRE data models.</p>
</section><section id="inspire-and-gml"><div class="header-wrapper"><h4 id="x3-4-6-inspire-and-gml"><bdi class="secno">3.4.6 </bdi>INSPIRE and GML</h4><a class="self-link" href="#inspire-and-gml" aria-label="Permalink for Section 3.4.6"></a></div>
<p>The use of GML as encoding for INSPIRE data can be considered in two ways: as input and as output.</p>
<p>When we consider the input, one would like to be able to use a source dataset of harmonized data. In most cases, this will be a GML encoded dataset. 
The GML encoding is at least needed to validate the data set with the <a href="https://inspire.ec.europa.eu/validator/about/">EU INSPIRE  validator</a>.<br>Unfortunately, not many tooling for creating an OAPIF service is able to use GML as input. Especially when it concerns a complex GML dataset. So, a transformation to another encoding like GeoJSON is needed.</p>
<p>Output of GML from the OAPIF service can only be in simple features <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_requirements_class_geography_markup_language_gml_simple_features_profile_level_0">level 0</a> and <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_requirements_class_geography_markup_language_gml_simple_features_profile_level_2">level 2</a>.
So no complex features will be supported.</p>
</section><section id="inspire-describing-encoding"><div class="header-wrapper"><h4 id="x3-4-7-inspire-describing-encoding"><bdi class="secno">3.4.7 </bdi>INSPIRE Describing encoding</h4><a class="self-link" href="#inspire-describing-encoding" aria-label="Permalink for Section 3.4.7"></a></div>
<p>The standards considered in this guideline do not set a specific encoding as mandatory (see <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_encodings">https://www.opengis.net/doc/IS/ogcapi-features-1/1.0#_encodings</a>) [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-1" title="OGC API Features Part1:Core">PUB-1</a></cite>].
If another encoding than GML is used for publishing an INSPIRE dataset, data providers need to document how the encoding relates to the concerned INSPIRE data model.
The good practice on <a href="https://github.com/INSPIRE-MIF/gp-geopackage-encodings/blob/main/spec/GeoPackage_Good_Practice_initiation_fiche.md">GeoPackages encoding of INSPIRE datasets</a> describes how this can be done.</p>
</section></section><section id="relevant-documentation"><div class="header-wrapper"><h3 id="x3-5-relevant-documentation"><bdi class="secno">3.5 </bdi>Relevant documentation</h3><a class="self-link" href="#relevant-documentation" aria-label="Permalink for Section 3.5"></a></div>
<p>Relevant documentation is shown in <a href="#references">appendix A. References</a>.</p>
</section></section>
  <section id="H04"><div class="header-wrapper"><h2 id="x4-examples-of-implementations"><bdi class="secno">4. </bdi>Examples of implementations</h2><a class="self-link" href="#H04" aria-label="Permalink for Section 4."></a></div>
<p>From earlier tests Geonovum concluded that tools were not compliant with the requirements for OAS, OGC, INSPIRE and Dutch ADR. 
For that reason Geonovum set up an open tender at the beginning of the year 2023, with the goal of improving the compliance of OGC API tooling.
This resulted in 3 demo services that each show how you can be compliant with the requirements.
These demo services used the same selection of the Dutch INSPIRE Addresses in a simplified GML file, constructed by Wetransform as input.
Next to these demo services, an other 4th service that is in production is reviewed in regards to the standards.</p>
<table>
<thead>
<tr>
<th>tool</th>
<th>main contributions</th>
<th>landing page</th>
</tr>
</thead>
<tbody><tr>
<td>Pygeoapi</td>
<td>Justobjects and Geocat</td>
<td><a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1">https://apitestbed.geonovum.nl/adr_pygeoapi/v1</a></td>
</tr>
<tr>
<td>Geoserver</td>
<td>Geosolutions</td>
<td><a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1</a></td>
</tr>
<tr>
<td>Deegree</td>
<td>Wetransform</td>
<td><a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1">https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1</a></td>
</tr>
<tr>
<td>Gokoala</td>
<td>PDOK</td>
<td><a href="https://api.pdok.nl/brt/top10nl/ogc/v1">https://api.pdok.nl/brt/top10nl/ogc/v1</a></td>
</tr>
</tbody></table>
<p>Per tool, findings are elaborated in the next chapters when relevant. They are held to the requirements in the standards as stated in chapter 3.
Not all standards are regarded, since they were not yet established at the time the services were set online. This applies for example to the common and filtering standard.</p>
<section id="pygeoapi-versus-requirements"><div class="header-wrapper"><h3 id="x4-1-pygeoapi-versus-requirements"><bdi class="secno">4.1 </bdi>Pygeoapi versus requirements</h3><a class="self-link" href="#pygeoapi-versus-requirements" aria-label="Permalink for Section 4.1"></a></div>
<p>The following findings show how Pygeoapi complies to the requirements with an OAPIF service for INSPIRE harmonized Dutch Addresses.</p>
<section id="oas-0"><div class="header-wrapper"><h4 id="x4-1-1-oas"><bdi class="secno">4.1.1 </bdi>OAS</h4><a class="self-link" href="#oas-0" aria-label="Permalink for Section 4.1.1"></a></div>
<p>The OAS document is available: <a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/openapi">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/openapi</a></p>
</section><section id="ogc-0"><div class="header-wrapper"><h4 id="x4-1-2-ogc"><bdi class="secno">4.1.2 </bdi>OGC</h4><a class="self-link" href="#ogc-0" aria-label="Permalink for Section 4.1.2"></a></div>
<p>The OGC CITE validator gave no error at the <a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1">landing page</a>.</p>
<p><em><strong>Filtering</strong></em>  </p>
<p>For the use of filters, the bbox and items options were already available. In addition, one can filter on the attributes which can be retrieved from
<a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/queryables">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/queryables</a>.
<a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items?filter=locator_designator_postalDeliveryIdentifier=%279901AA%27">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items?filter=locator_designator_postalDeliveryIdentifier=%279901AA%27</a> does unfortunately not work.</p>
<p>The OGC API specification for filtering [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-6" title="OGC API - Features - Part 3: Filtering and the Common Query Language">PUB-6</a></cite>] did not yet have the status "approved" at the time of this service publication and has therefore not been considered further.</p>
<p><em><strong>CRS</strong></em></p>
<p>The crs identifier list and storage-crs can be found at the end of:
<a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL?f=json">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL?f=json</a> </p>
<p>With the following command line request, one can see the Content-CRS value in the header:</p>
<p><code>curl -i https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items/1?f=json</code></p>
<p>An adjustment has been made to the bbox filter. It now also supports the bbox-crs parameter.
Only 2 addresses are available in the below defined bbox.
<a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items?f=json&amp;bbox-crs=http://www.opengis.net/def/crs/EPSG/0/28992&amp;bbox=252200,593000,252710,594000">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items?f=json&amp;bbox-crs=http://www.opengis.net/def/crs/EPSG/0/28992&amp;bbox=252200,593000,252710,594000</a></p>
</section><section id="dutch-api-design-rules-0"><div class="header-wrapper"><h4 id="x4-1-3-dutch-api-design-rules"><bdi class="secno">4.1.3 </bdi>Dutch API design rules</h4><a class="self-link" href="#dutch-api-design-rules-0" aria-label="Permalink for Section 4.1.3"></a></div>
<p>It complies with all the rules, except for rule <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash">https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash</a>.
This rule in the Dutch ADR prescribes that none of the API endpoints should have a trailing slash. However, the OGC specification states that the landing page (i.e. "Home") should have a trailing slash. So the rules contradict.
It is expected that in future, this ADR-rule will make an exception for the landing page.</p>
</section><section id="inspire-0"><div class="header-wrapper"><h4 id="x4-1-4-inspire"><bdi class="secno">4.1.4 </bdi>INSPIRE</h4><a class="self-link" href="#inspire-0" aria-label="Permalink for Section 4.1.4"></a></div>
<p><em><strong>CRS ETRS89 and WGS84</strong></em></p>
<p>The required CRS's are available:</p>
<ul>
<li>RD: <a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/28992">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/28992</a></li>
<li>WGS84: <a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/OGC/1.3/CRS84">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/OGC/1.3/CRS84</a></li>
<li>ETRS89:  <a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258</a></li>
</ul>
<p><em><strong>Predefined download</strong></em>  </p>
<p>Link to metadata of dataset: passed at <code>/collections/AddressesNL</code> and at <code>/collections</code> level:<br><code>{"href": "https://www.nationaalgeoregister.nl/geonetwork/srv/dut/catalog.search#/metadata/a5f961e9-ebdd-41e2-b8e8-ab33ed340a83",   "hreflang": "nl",   "type": "text/html",   "rel": "describedby",   "title": "Metadata as HTML"}</code></p>
<p><code>{"href": "https://www.nationaalgeoregister.nl/geonetwork/srv/api/records/a5f961e9-ebdd-41e2-b8e8-ab33ed340a83/formatters/xml",   "hreflang": "nl",   "type": "application/xml",   "rel": "describedby",   "title": "Metadata as ISO 19139 XML"}</code></p>
<p>Link to INSPIRE feature concept dictionary: passed at /collections/AddressesNL and at /collections level:<br><code>{"href": "https://inspire.ec.europa.eu/featureconcept/Address",   "hreflang": "en",   "type": "text/html",   "rel": "tag",   "title": "INSPIRE feature concept dictionary for addresses"}</code></p>
<p>Link to the license: passed at /collections/AddressesNL and at /collections level:<br><code>{"href": "https://creativecommons.org/publicdomain/zero/1.0/deed.en",   "hreflang": "en",   "type": "text/html",   "rel": "license",   "title": "CC0 1.0 Public Domain license"}</code></p>
<p>See also <a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections?f=json">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections?f=json</a> and 
<a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL?f=json">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL?f=json</a></p>
<p><em><strong>bulk download</strong></em></p>
<p>Link to bulk download of dataset: passed at /collections/AddressesNL and at /collections level.</p>
<p>See also <a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections?f=json">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections?f=json</a> and<br><a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL?f=json">https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL?f=json</a>
<code>{"href": "https://service.pdok.nl/kadaster/ad/atom/downloads/addresses.gml.gz",   "hreflang": "nl",   "length": 685450191,   "type": "application/x-gmz",   "rel": "enclosure",   "title": "Download complete dataset as GML"}</code></p>
<p><em><strong>GeoJSON</strong></em></p>
<p>Items can be retrieved in GeoJSON by requesting:  </p>
<p><code>https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL/items?f=json</code></p>
<p><em><strong>GML</strong></em> </p>
<p>As input, a simple features GML file was used as produced by Wetransform from the complex feature GML with the transformation software Hale.  </p>
<p>As output, there is a link to the original complex feature GML-file:
<a href="https://service.pdok.nl/kadaster/ad/atom/downloads/addresses.gml.gz">https://service.pdok.nl/kadaster/ad/atom/downloads/addresses.gml.gz</a> </p>
<p>Pygeoapi does not support GML-output at item-level, but this is not a requirement.</p>
<p><em><strong>Describing encoding</strong></em>  </p>
<p>There is a link to <a href="https://github.com/INSPIRE-MIF/2017.2/tree/master/GeoJSON/ads">https://github.com/INSPIRE-MIF/2017.2/tree/master/GeoJSON/ads</a> at <a href="https://apitestbed.geonovum.nl/adr_pygeoapi/v1/collections/AddressesNL?f=json">collections/AddressesNL level</a>:  </p>
<p><code>{"href": "https://github.com/INSPIRE-MIF/2017.2/tree/master/GeoJSON/ads",   "hreflang": "en",   "type": "text/html",   "rel": "about",   "title": "Description of the encoding"}</code>  </p>
</section><section id="other-findings-on-pygeoapi"><div class="header-wrapper"><h4 id="x4-1-5-other-findings-on-pygeoapi"><bdi class="secno">4.1.5 </bdi>Other findings on Pygeoapi</h4><a class="self-link" href="#other-findings-on-pygeoapi" aria-label="Permalink for Section 4.1.5"></a></div>
<p>More information about the Pygeoapi adjustments to the standards can be found at <a href="https://pygeoapi.io/presentations/geonovum-tender-2023/">https://pygeoapi.io/presentations/geonovum-tender-2023/</a></p>
</section></section><section id="geoserver-versus-requirements"><div class="header-wrapper"><h3 id="x4-2-geoserver-versus-requirements"><bdi class="secno">4.2 </bdi>Geoserver versus requirements</h3><a class="self-link" href="#geoserver-versus-requirements" aria-label="Permalink for Section 4.2"></a></div>
<p>The following findings show how Geoserver complies to the requirements with an OAPIF service for INSPIRE harmonized Dutch Addresses.</p>
<section id="oas-1"><div class="header-wrapper"><h4 id="x4-2-1-oas"><bdi class="secno">4.2.1 </bdi>OAS</h4><a class="self-link" href="#oas-1" aria-label="Permalink for Section 4.2.1"></a></div>
<p>The OAS document is available: <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/openapi">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/openapi</a></p>
</section><section id="ogc-1"><div class="header-wrapper"><h4 id="x4-2-2-ogc"><bdi class="secno">4.2.2 </bdi>OGC</h4><a class="self-link" href="#ogc-1" aria-label="Permalink for Section 4.2.2"></a></div>
<p>The OGC CITE validator gave no error at the landing page <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1</a>.</p>
<p><em><strong>Filtering</strong></em>  </p>
<p>For the use of filters, the bbox and items options were already available. In addition, one can filter on the attributes which can be retrieved from:
<a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?queryables">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?queryables</a>.
<a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items?filter=locator_designator_postalDeliveryIdentifier=%279901AA%27">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items?filter=locator_designator_postalDeliveryIdentifier=%279901AA%27</a> only gives the addresses with postal code '9901AA'. </p>
<p>The OGC API specification for filtering [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-6" title="OGC API - Features - Part 3: Filtering and the Common Query Language">PUB-6</a></cite>] did not yet have the status "approved" at the time of this service publication and has therefor not been considered further.</p>
<p><em><strong>CRS</strong></em></p>
<p>The crs identifier list and the storage-crs can be found at:
<a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?f=json">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?f=json</a></p>
<p>With the following command line request, one can see the Content-CRS value in the header :</p>
<p><code>curl -i https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items/1?f=json</code></p>
<p>An adjustment has been made to the bbox filter. It now also supports the bbox-crs parameter.
Only 2 addresses are available in the below defined bbox.  </p>
<p><a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items?f=json&amp;bbox-crs=http://www.opengis.net/def/crs/EPSG/0/28992&amp;bbox=252200,593000,252710,594000">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items?f=json&amp;bbox-crs=http://www.opengis.net/def/crs/EPSG/0/28992&amp;bbox=252200,593000,252710,594000</a></p>
</section><section id="dutch-api-design-rules-1"><div class="header-wrapper"><h4 id="x4-2-3-dutch-api-design-rules"><bdi class="secno">4.2.3 </bdi>Dutch API design rules</h4><a class="self-link" href="#dutch-api-design-rules-1" aria-label="Permalink for Section 4.2.3"></a></div>
<p>It complies with all the rules, except for rule <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash">https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash</a>.
This rule in the Dutch ADR prescribes that none of the API endpoints should have a trailing slash. However, the OGC specification states that the landing page (i.e. "Home") should have a trailing slash. So the rules contradict.
It is expected that in future, this ADR-rule will make an exception for the landing page.</p>
</section><section id="inspire-1"><div class="header-wrapper"><h4 id="x4-2-4-inspire"><bdi class="secno">4.2.4 </bdi>INSPIRE</h4><a class="self-link" href="#inspire-1" aria-label="Permalink for Section 4.2.4"></a></div>
<p><em><strong>CRS ETRS89 and WGS84</strong></em></p>
<p>The required CRS's are available:</p>
<ul>
<li>RD: <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/28992">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/28992</a></li>
<li>WGS84: <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/OGC/1.3/CRS84">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/OGC/1.3/CRS84</a></li>
<li>ETRS89:  <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258">https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items/1?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258</a></li>
</ul>
<p><em><strong>Predefined download</strong></em>  </p>
<p>Link to metadata of dataset: passed at <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?f=json">/collections/collection level</a> and at <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections?f=json">/collections level</a>. 
<code>{"href":"https://www.nationaalgeoregister.nl/geonetwork/srv/api/records/a5f961e9-ebdd-41e2-b8e8-ab33ed340a83/formatters/xml?approved=true","rel":"describedBy","type":"application/xml","title":"ISO metadata for this dataset"}</code></p>
<p>Link to INSPIRE feature concept dictionary: passed at <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?f=json">/collections/collection level</a>. 
<code>{"href":"https://inspire.ec.europa.eu/featureconcept/Address","rel":"tag","type":"text/html","title":"INSPIRE Address feature concept."}</code></p>
<p>Link to the license: passed at <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections?f=json">/collections level</a>. 
<code>{"href":"http://creativecommons.org/publicdomain/zero/1.0/deed.nl","rel":"license","type":"text/html","title":"Dataset license."}</code></p>
<p><em><strong>bulk download</strong></em></p>
<p>Link to bulk download of dataset: passed at <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?f=json">/collections/collection level</a>.<br><code>{"href":"https://geonovum.geosolutionsgroup.com/geoserver/www/ADNL.gpkg","rel":"enclosure","type":"application/geopackage+sqlite3","title":"Addresses raw data."}</code></p>
<p><em><strong>GeoJSON</strong></em></p>
<p>Items can be retrieved in GeoJSON by requesting:</p>
<p><code>https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items/1?f=application%2Fgeo%2Bjson</code></p>
<p><em><strong>GML</strong></em> </p>
<p>As input, a simple features GML file was used as produced by Wetransform from the complex feature GML with the transformation software Hale.  </p>
<p>As output, the following link can be found at <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?f=json">/collections/collection level</a>. It can be used to download the first 50 records. </p>
<p><code>{"href":"https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress/items?f=application%2Fgml%2Bxml%3Bversion%3D3.2","rel":"items","type":"application/gml+xml;version=3.2","title":"Addresses items as application/gml+xml;version=3.2"}</code> </p>
<p><em><strong>Describing encoding</strong></em>  </p>
<p>There is a link to <a href="https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/ads/simple-addresses.md">https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/ads/simple-addresses.md</a> at <a href="https://geonovum.geosolutionsgroup.com/geoserver/inspire/ogc/features/v1/collections/SimpleAddress?f=json">/collections/collection level</a>. </p>
<p><code>{"href":"https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/ads/simple-addresses.md","rel":"describedBy","type":"text/html","title":"GeoJSON Encoding Rule for INSPIRE Addresses"}</code></p>
</section><section id="other-findings-on-geoserver"><div class="header-wrapper"><h4 id="x4-2-5-other-findings-on-geoserver"><bdi class="secno">4.2.5 </bdi>Other findings on Geoserver</h4><a class="self-link" href="#other-findings-on-geoserver" aria-label="Permalink for Section 4.2.5"></a></div>
<p>More information about the Geoserver adjustments to the standards can be found at <a href="https://www.geonovum.nl/uploads/documents/Geosolutions.pdf">https://www.geonovum.nl/uploads/documents/Geosolutions.pdf</a></p>
</section></section><section id="deegree-versus-requirements"><div class="header-wrapper"><h3 id="x4-3-deegree-versus-requirements"><bdi class="secno">4.3 </bdi>Deegree versus requirements</h3><a class="self-link" href="#deegree-versus-requirements" aria-label="Permalink for Section 4.3"></a></div>
<p>The following findings show how Geoserver complies to the requirements with an OAPIF service for INSPIRE harmonized Dutch Addresses.</p>
<section id="oas-2"><div class="header-wrapper"><h4 id="x4-3-1-oas"><bdi class="secno">4.3.1 </bdi>OAS</h4><a class="self-link" href="#oas-2" aria-label="Permalink for Section 4.3.1"></a></div>
<p>The OAS document is available: <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/openapi">https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/openapi</a></p>
</section><section id="ogc-2"><div class="header-wrapper"><h4 id="x4-3-2-ogc"><bdi class="secno">4.3.2 </bdi>OGC</h4><a class="self-link" href="#ogc-2" aria-label="Permalink for Section 4.3.2"></a></div>
<p>The OGC CITE validator gave no error at the landing page: <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1">https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1</a>.</p>
<p><em><strong>Filtering</strong></em>  </p>
<p>For the use of filters, the bbox and items options were already available.</p>
<p>The OGC API specification for filtering [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-6" title="OGC API - Features - Part 3: Filtering and the Common Query Language">PUB-6</a></cite>] did not yet have the status "approved" at the time of this service publication and has therefor not been considered.</p>
<p><em><strong>CRS</strong></em></p>
<p>The crs identifier list and storage-crs can be found at:
<a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress?f=json">https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress?f=json</a></p>
<p>With the following command line request, one can see the Content-CRS value in the header :</p>
<p><code>curl -i https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items?limit=1</code></p>
<p>An adjustment has been made tot the bbox filter. It now also supports the bbox-crs parameter.
Only 2 addresses are available in the below defined bbox.
<a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items?f=json&amp;bbox-crs=http://www.opengis.net/def/crs/EPSG/0/28992&amp;bbox=252200,593000,252710,594000">https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items?f=json&amp;bbox-crs=http://www.opengis.net/def/crs/EPSG/0/28992&amp;bbox=252200,593000,252710,594000</a></p>
</section><section id="dutch-api-design-rules-2"><div class="header-wrapper"><h4 id="x4-3-3-dutch-api-design-rules"><bdi class="secno">4.3.3 </bdi>Dutch API design rules</h4><a class="self-link" href="#dutch-api-design-rules-2" aria-label="Permalink for Section 4.3.3"></a></div>
<p>It complies with all the rules, except for one.
It does not comply with the rule <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash">https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash</a>.
This rule in the Dutch ADR prescribes that none of the API endpoints should have a trailing slash. However, the OGC specification states that the landing page (i.e. "Home") should have a trailing slash. So the rules contradict.
It is expected that in future, this ADR-rule will make an exception for the landing page.</p>
</section><section id="inspire-2"><div class="header-wrapper"><h4 id="x4-3-4-inspire"><bdi class="secno">4.3.4 </bdi>INSPIRE</h4><a class="self-link" href="#inspire-2" aria-label="Permalink for Section 4.3.4"></a></div>
<p><em><strong>CRS ETRS89 and WGS84</strong></em></p>
<p>The required CRS's are available:</p>
<ul>
<li>RD: <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items/nl-imbag-ad-address-0003200000133985?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/28992">https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items/nl-imbag-ad-address-0003200000133985?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/28992</a></li>
<li>WGS84: <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items/nl-imbag-ad-address-0003200000133985?f=json&amp;crs=http://www.opengis.net/def/crs/OGC/1.3/CRS84">https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items/nl-imbag-ad-address-0003200000133985?f=json&amp;crs=http://www.opengis.net/def/crs/OGC/1.3/CRS84</a></li>
<li>ETRS89: <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items/nl-imbag-ad-address-0003200000133985?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258">https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress/items/nl-imbag-ad-address-0003200000133985?f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258</a></li>
</ul>
<p><em><strong>Predefined download</strong></em>  </p>
<p>Link to metadata of dataset: passed at <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections?f=json">/collections level</a>:  </p>
<p><code>{"href":"https://www.nationaalgeoregister.nl/geonetwork/srv/dut/catalog.search#/metadata/a5f961e9-ebdd-41e2-b8e8-ab33ed340a83","rel":"describedby","type":"text/html","title":"Metadata"}</code></p>
<p>Link to INSPIRE feature concept dictionary: passed at <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress?f=json">/collections/collection level</a> and at <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections?f=json">/collections level</a>:  </p>
<p><code>{"href":"https://inspire.ec.europa.eu/featureconcept/Address","rel":"tag","type":"text/html","title":"Feature concept Address"}</code></p>
<p>Link to the license: passed at <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections?f=json">/collections level</a>:  </p>
<p><code>{"href":"http://creativecommons.org/publicdomain/zero/1.0/deed.nl","rel":"license","type":"text/html","title":"License"}</code></p>
<p><em><strong>bulk download</strong></em></p>
<p>Link to bulk download of dataset: passed at <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress?f=json">/collections/collection level</a> and at <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections?f=json">/collections level</a>. </p>
<p><code>{"href":"http://test.haleconnect.de/ogcapi/datasets/simplified-addresses/collections/SimpleAddress/items?bulk=true","rel":"enclosure","type":"application/xml","title":"Download all features as GML"}</code> 
<code>{"href":"http://test.haleconnect.de/ogcapi/datasets/simplified-addresses/collections/SimpleAddress/items?bulk=true","rel":"enclosure","type":"application/json","title":"Download all features as GeoJSON"}</code> </p>
<p><em><strong>GeoJSON</strong></em></p>
<p>Items can be retrieved in GeoJSON by requesting:  </p>
<p><code>https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/collections/SimpleAddress/items?f=json&amp;limit=1</code></p>
<p> or</p>
<p><code>https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/collections/SimpleAddress/items/nl-imbag-ad-address-0003200000133985?f=json</code></p>
<p><em><strong>GML</strong></em> </p>
<p>As input, a simple features GML file was used as produced by Wetransform from the complex feature GML with the transformation software Hale.
As output, the following links can be found at <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections/SimpleAddress?f=json">/collections/collection level</a>. They can be used to download specific records.</p>
<p><code>{"href":"http://test.haleconnect.de/ogcapi/datasets/simplified-addresses/collections/SimpleAddress/items?bulk=true","rel":"enclosure","type":"application/xml","title":"Download all features as GML"}</code> </p>
<p>or </p>
<p><code>{"href":"http://test.haleconnect.de/ogcapi/datasets/simplified-addresses/collections/SimpleAddress/items","rel":"items","type":"application/gml+xml;version=3.2","title":"Features as GML"}</code></p>
<p><a href="http://test.haleconnect.de/ogcapi/datasets/simplified-addresses/collections/SimpleAddress/items?f=xml">use parameter <code>f=xml</code></a></p>
<p><em><strong>Describing encoding</strong></em>  </p>
<p>There is a link to <a href="https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/ads">https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/ads</a> at <a href="https://test.haleconnect.de/ogcapi/datasets/simplified-addresses/v1/collections?f=json">/collections/collection level</a>. </p>
<p><code>{"href":"https://github.com/INSPIRE-MIF/2017.2/tree/master/GeoJSON/ads","rel":"describedby","type":"text/html","title":"Encoding description"}</code></p>
</section><section id="other-findings-on-deegree"><div class="header-wrapper"><h4 id="x4-3-5-other-findings-on-deegree"><bdi class="secno">4.3.5 </bdi>Other findings on Deegree</h4><a class="self-link" href="#other-findings-on-deegree" aria-label="Permalink for Section 4.3.5"></a></div>
<p>More information about the Deegree adjustments to the standards can be found at <a href="https://www.geonovum.nl/uploads/documents/deegree%20OGC%20API%20Features.pdf">https://www.geonovum.nl/uploads/documents/deegree%20OGC%20API%20Features.pdf</a></p>
</section></section><section id="gokoala-brt-versus-requirements"><div class="header-wrapper"><h3 id="x4-4-gokoala-brt-versus-requirements"><bdi class="secno">4.4 </bdi>Gokoala BRT versus requirements</h3><a class="self-link" href="#gokoala-brt-versus-requirements" aria-label="Permalink for Section 4.4"></a></div>
<p>The following findings show how Gokoala with the OAF service for the BRT dataset complies to the requirements.</p>
<section id="oas-3"><div class="header-wrapper"><h4 id="x4-4-1-oas"><bdi class="secno">4.4.1 </bdi>OAS</h4><a class="self-link" href="#oas-3" aria-label="Permalink for Section 4.4.1"></a></div>
<p>The OAS document is available at: <a href="https://api.pdok.nl/brt/top10nl/ogc/v1/api">https://api.pdok.nl/brt/top10nl/ogc/v1/api</a></p>
</section><section id="ogc-3"><div class="header-wrapper"><h4 id="x4-4-2-ogc"><bdi class="secno">4.4.2 </bdi>OGC</h4><a class="self-link" href="#ogc-3" aria-label="Permalink for Section 4.4.2"></a></div>
<p>The OGC CITE validator gave no error at the landing page: <a href="https://api.pdok.nl/brt/top10nl/ogc/v1">https://api.pdok.nl/brt/top10nl/ogc/v1</a>.</p>
<p><em><strong>Filtering</strong></em>  </p>
<p>For the use of filters, the bbox and items options were available.
<a href="https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/queryables">https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/queryables</a> is not supported.</p>
<p>The OGC API specification for filtering [<cite><a class="bibref" data-link-type="biblio" href="#bib-pub-6" title="OGC API - Features - Part 3: Filtering and the Common Query Language">PUB-6</a></cite>] did not yet have the status "approved" at the time of this service publication and has therefor not been considered further.</p>
<p><em><strong>CRS</strong></em></p>
<p>The crs identifier list and storage-crs can be found at:
<a href="https://api.pdok.nl/brt/top10nl/ogc/v1/collections?f=json">https://api.pdok.nl/brt/top10nl/ogc/v1/collections?f=json</a> where it is repeated for each collection.
and at each collection level, for instance: <a href="https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt?f=json">https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt?f=json</a></p>
<p>With the following command line request, one can see the Content-CRS value in the header :</p>
<p><code>curl -i https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1</code></p>
<p>It supports the bbox filter and the bbox-crs parameter.
Only 5 points are available in the below defined bbox:
<a href="https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?bbox-crs=http://www.opengis.net/def/crs/EPSG/0/28992&amp;bbox=252000,593000,253000,594000">https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?bbox-crs=http://www.opengis.net/def/crs/EPSG/0/28992&amp;bbox=252000,593000,253000,594000</a></p>
</section><section id="dutch-api-design-rules-3"><div class="header-wrapper"><h4 id="x4-4-3-dutch-api-design-rules"><bdi class="secno">4.4.3 </bdi>Dutch API design rules</h4><a class="self-link" href="#dutch-api-design-rules-3" aria-label="Permalink for Section 4.4.3"></a></div>
<p>It complies with all the rules, except for rule <a href="https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash">https://gitdocumentatie.logius.nl/publicatie/api/adr/#/core/no-trailing-slash</a>.<br>The rule "no-trailing-slash" in the Dutch ADR prescribes that none of the API endpoints should have a trailing slash. However, the OGC specification states that the landing page (i.e. "Home") should have a trailing slash. So the rules contradict.
It is expected that in future, this ADR-rule will make an exception for the landing page.  </p>
</section><section id="inspire-3"><div class="header-wrapper"><h4 id="x4-4-4-inspire"><bdi class="secno">4.4.4 </bdi>INSPIRE</h4><a class="self-link" href="#inspire-3" aria-label="Permalink for Section 4.4.4"></a></div>
<p>The dataset BRT is an INSPIRE dataset AsIs and not an INSPIRE harmonized dataset, so not all the INSPIRE requirements are applicable.
Because the INSPIRE requirements can still be relevant they have been viewed, despite the fact that they are not all applicable. </p>
<p><em><strong>CRS ETRS89 and WGS84</strong></em></p>
<p>The required CRS's are available:</p>
<ul>
<li>RD: <a href="https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1&amp;f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/28992">https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1&amp;f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/28992</a></li>
<li>WGS84: <a href="https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1&amp;f=json&amp;crs=http://www.opengis.net/def/crs/OGC/1.3/CRS84">https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1&amp;f=json&amp;crs=http://www.opengis.net/def/crs/OGC/1.3/CRS84</a></li>
<li>ETRS89: <a href="https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1&amp;f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258">https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1&amp;f=json&amp;crs=http://www.opengis.net/def/crs/EPSG/0/4258</a></li>
</ul>
<p><em><strong>Predefined download</strong></em>  </p>
<p>Link to metadata of dataset: passed at <a href="https://api.pdok.nl/brt/top10nl/ogc/v1?f=json">Landing page level</a>:  </p>
<p><code>{"href":"https://www.nationaalgeoregister.nl/geonetwork/srv/dut/catalog.search#/metadata/29d5310f-dd0d-45ba-abad-b4ffc6b8785f","rel":"http://www.opengis.net/def/rel/ogc/1.0/data-meta","title":"Metadata for dataset at Nationaal Georegister"}</code></p>
<p>No Link to INSPIRE feature concept dictionary, because it is not an INSPIRE harmonized dataset.</p>
<p>Link to the license: passed at <a href="https://api.pdok.nl/brt/top10nl/ogc/v1/collections?f=json">/collections level</a> and <a href="https://api.pdok.nl/brt/top10nl/ogc/v1?f=json">Landing page level</a>:  </p>
<p><code>{"href":"https://creativecommons.org/licenses/by/4.0/deed.nl","rel":"license","type":"text/html","title":"CC BY 4.0"}</code></p>
<p><em><strong>bulk download</strong></em></p>
<p>No Link to bulk download of dataset is provided, although it does exist: <a href="https://service.pdok.nl/brt/topnl/atom/top10nl.xml">https://service.pdok.nl/brt/topnl/atom/top10nl.xml</a>.</p>
<p><em><strong>GeoJSON</strong></em></p>
<p>The first items can be retrieved in GeoJSON or JsonFG by requesting:  </p>
<p><code>https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1&amp;f=json</code> or <code>https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items?limit=1&amp;f=jsonfg</code></p>
<p> or items can be retrieved by ID:</p>
<p><code>https://api.pdok.nl/brt/top10nl/ogc/v1/collections/gebouw_punt/items/a7b7566b-9be9-57fb-bd05-33dd417505f3?f=json</code></p>
<p><em><strong>GML</strong></em> </p>
<p>The input encoding options of Gokoala have not been investigated and are unknown for this dataset. The output of GML is not supported.</p>
<p><em><strong>Describing encoding</strong></em>  </p>
<p>The describing of the encoding is not relevant, since it is no INSPIRE harmonized dataset.</p>
</section><section id="other-findings-on-gokoala-brt-oapif"><div class="header-wrapper"><h4 id="x4-4-5-other-findings-on-gokoala-brt-oapif"><bdi class="secno">4.4.5 </bdi>Other findings on Gokoala BRT OAPIF.</h4><a class="self-link" href="#other-findings-on-gokoala-brt-oapif" aria-label="Permalink for Section 4.4.5"></a></div>
<p>More information about the Gokoala can be found at <a href="https://github.com/PDOK/gokoala">https://github.com/PDOK/gokoala</a> and <a href="https://api.pdok.nl/">https://api.pdok.nl/</a></p>
</section></section><section id="general-findings"><div class="header-wrapper"><h3 id="x4-5-general-findings"><bdi class="secno">4.5 </bdi>General findings</h3><a class="self-link" href="#general-findings" aria-label="Permalink for Section 4.5"></a></div>
<ol>
<li>There has been discussion whether the predefined download links should be at collections or collections/collection level. See also: <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/issues/91">https://github.com/INSPIRE-MIF/gp-ogc-api-features/issues/91</a>.<br>During the project of adjusting the tools we had the opinion that both should be possible.<br>Afterwards, we found out that it should be at collections level since it is one of the <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md#main-principles">main principles</a> in [PUB-2] to use one data set in one API.
Again, later we realized other kinds of OGC-API services like Tiles, can exist together on the same landing page. In that case, these links could also be provided on the landing page, also because not all OGC-API types have collections. 
This was discussed at <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/issues/93">https://github.com/INSPIRE-MIF/gp-ogc-api-features/issues/93</a>.</li>
<li>The protocol element in the metadata is based on a codelist. The protocol element is used to state the type of service.
A new protocol "OGC API-Features" was added to the list of <a href="https://inspire.ec.europa.eu/metadata-codelist/ProtocolValue:1">protocol values</a>. 
But the given <a href="http://www.opengis.net/def/docs/17-069r3">link</a> behind the label does not resolve.
The Dutch <a href="https://docs.geostandaarden.nl/md/mdprofiel-iso19115/#protocol">ISO19115 metadata standard</a> also provides a codelist for the protocol element to state the type of service. 
It has the value: "OGC:API features" in <a href="https://docs.geostandaarden.nl/md/mdprofiel-iso19115/#codelist-protocol">https://docs.geostandaarden.nl/md/mdprofiel-iso19115/#codelist-protocol</a>.
The <a href="http://www.opengis.net/def/interface/ogcapi-features">uri</a> provided there, does also not resolve.</li>
<li>Another blocking issue before implementation of the OAPIF for INSPIRE is that descriptions of encodings other than GML are not yet available for most INSPIRE themes.</li>
<li>Complex GML as input and output are difficult as long as tooling (server and client) expects simple encodings.</li>
<li>One could discuss if it is useful to publish complex GML as output, because it is not in line with the aim of OGI API Features: easy to use for developers.</li>
<li>Complex GML as input needs a flattening of the data. This is needed for the software that publishes the features. It can only work with simple features, with one value per attribute and without relations to other objects.
This is often not the case with the more complex INSPIRE models.</li>
</ol>
</section><section id="documentation"><div class="header-wrapper"><h3 id="x4-6-documentation"><bdi class="secno">4.6 </bdi>Documentation</h3><a class="self-link" href="#documentation" aria-label="Permalink for Section 4.6"></a></div>
<p>Presentations of tool adjustments can be found here: <a href="https://www.geonovum.nl/over-geonovum/actueel/presentatie-resultaten-aanbesteding-ogc-api-features-toolaanpassing">https://www.geonovum.nl/over-geonovum/actueel/presentatie-resultaten-aanbesteding-ogc-api-features-toolaanpassing</a></p>
<p>OGC certified software: <a href="https://portal.ogc.org/public_ogc/compliance/compliant.php?display_opt=1&amp;specid=1022">https://portal.ogc.org/public_ogc/compliance/compliant.php?display_opt=1&amp;specid=1022</a> 
Other software: <a href="https://github.com/opengeospatial/ogcapi-features/tree/master/implementations">https://github.com/opengeospatial/ogcapi-features/tree/master/implementations</a> 
These lists are growing and incomplete.</p>
</section></section>
  
  



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="a-references"><bdi class="secno">A. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix A."></a></div><section id="informative-references">
    <div class="header-wrapper"><h3 id="a-1-informative-references"><bdi class="secno">A.1 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix A.1"></a></div>
    <dl class="bibliography"><dt id="bib-pub-1">[PUB-1]</dt><dd>
      <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0"><cite>OGC API Features Part1:Core</cite></a>.  OGC. V1.0.1. URL: <a href="https://www.opengis.net/doc/IS/ogcapi-features-1/1.0">https://www.opengis.net/doc/IS/ogcapi-features-1/1.0</a>
    </dd><dt id="bib-pub-2">[PUB-2]</dt><dd>
      <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md"><cite>Setting up an INSPIRE Download service based on the OGC API-Features standard</cite></a>.  INSPIRE-MIF. V1.0. URL: <a href="https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md">https://github.com/INSPIRE-MIF/gp-ogc-api-features/blob/master/spec/oapif-inspire-download.md</a>
    </dd><dt id="bib-pub-3">[PUB-3]</dt><dd>
      <a href="https://www.geonovum.nl/over-geonovum/actueel/rest-api-design-rules-op-pas-toe-leg-uit-lijst"><cite>Dutch API design rules</cite></a>.  https://www.geonovum.nl. 19 JULI 2020. URL: <a href="https://www.geonovum.nl/over-geonovum/actueel/rest-api-design-rules-op-pas-toe-leg-uit-lijst">https://www.geonovum.nl/over-geonovum/actueel/rest-api-design-rules-op-pas-toe-leg-uit-lijst</a>
    </dd><dt id="bib-pub-4">[PUB-4]</dt><dd>
      <a href="https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/geojson-encoding-rule.md#inspire-requirements-for-encoding-rules"><cite>INSPIRE UML-to-GeoJSON encoding rule</cite></a>.  Working group on Inspire Action 2017.2. V0.1. URL: <a href="https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/geojson-encoding-rule.md#inspire-requirements-for-encoding-rules">https://github.com/INSPIRE-MIF/2017.2/blob/master/GeoJSON/geojson-encoding-rule.md#inspire-requirements-for-encoding-rules</a>
    </dd><dt id="bib-pub-5">[PUB-5]</dt><dd>
      <a href="https://www.opengis.net/doc/IS/ogcapi-features-2/1.0"><cite>OGC API - Features - Part 2: Coordinate Reference Systems by Reference</cite></a>.  OGC. V1.0. URL: <a href="https://www.opengis.net/doc/IS/ogcapi-features-2/1.0">https://www.opengis.net/doc/IS/ogcapi-features-2/1.0</a>
    </dd><dt id="bib-pub-6">[PUB-6]</dt><dd>
      <a href="https://www.opengis.net/doc/IS/ogcapi-features-3/1.0"><cite>OGC API - Features - Part 3: Filtering and the Common Query Language</cite></a>.  OGC. V1.0. URL: <a href="https://www.opengis.net/doc/IS/ogcapi-features-3/1.0">https://www.opengis.net/doc/IS/ogcapi-features-3/1.0</a>
    </dd><dt id="bib-pub-7">[PUB-7]</dt><dd>
      <a href="https://www.opengis.net/doc/is/ogcapi-common-1/1.0"><cite>OGC API - Common - Part 1: Common standard for all OGC-APIs</cite></a>.  OGC. V1.0. URL: <a href="https://www.opengis.net/doc/is/ogcapi-common-1/1.0">https://www.opengis.net/doc/is/ogcapi-common-1/1.0</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><div class="sidelabel">Geonovum Guide - Living document</div><script src="https://gitdocumentatie.logius.nl/publicatie/respec/fixup.js"></script></body></html>